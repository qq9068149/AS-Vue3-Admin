import{n as F,b as R,D as W,h as q,B as Te,I as ye,d as fe,aA as ee,Y as j,j as B,at as C,aD as Ee,v as ve,J as he,x as de,P as $e,A as k,ax as le,R as se,K as X,au as we,E as xe,a0 as _e,az as Le}from"./index.7be5bb68.js";import{R as Fe}from"./index.1cf7c7ff.js";import{w as E}from"./raf.997cffb5.js";import{s as D}from"./supportsPassive.85a453c3.js";function ue(){var i=function e(t){e.current=t};return i}var G=function(e,t){var a,n=e.height,l=e.offset,r=e.prefixCls,v=e.onInnerResize,s=t.slots,h={},u={display:"flex",flexDirection:"column"};return l!==void 0&&(h={height:"".concat(n,"px"),position:"relative",overflow:"hidden"},u=F(F({},u),{},{transform:"translateY(".concat(l,"px)"),position:"absolute",left:0,right:0,top:0})),R("div",{style:h},[R(Fe,{onResize:function(c){var g=c.offsetHeight;g&&v&&v()}},{default:function(){return[R("div",{style:u,class:W(q({},"".concat(r,"-holder-inner"),r))},[(a=s.default)===null||a===void 0?void 0:a.call(s)])]}})])};G.displayName="Filter";G.inheritAttrs=!1;G.props={prefixCls:String,height:Number,offset:Number,onInnerResize:Function};const Ce=G;var ge=function(e,t){var a,n=e.setRef,l=t.slots,r=Te((a=l.default)===null||a===void 0?void 0:a.call(l));return r&&r.length?ye(r[0],{ref:n}):r};ge.props={setRef:{type:Function,default:function(){}}};const De=ge;var Ie=20;function ce(i){return"touches"in i?i.touches[0].pageY:i.pageY}const Ne=fe({compatConfig:{MODE:3},name:"ScrollBar",inheritAttrs:!1,props:{prefixCls:String,scrollTop:Number,scrollHeight:Number,height:Number,count:Number,onScroll:{type:Function},onStartMove:{type:Function},onStopMove:{type:Function}},setup:function(){return{moveRaf:null,scrollbarRef:ue(),thumbRef:ue(),visibleTimeout:null,state:ee({dragging:!1,pageY:null,startTop:null,visible:!1})}},watch:{scrollTop:{handler:function(){this.delayHidden()},flush:"post"}},mounted:function(){var e,t;(e=this.scrollbarRef.current)===null||e===void 0||e.addEventListener("touchstart",this.onScrollbarTouchStart,D?{passive:!1}:!1),(t=this.thumbRef.current)===null||t===void 0||t.addEventListener("touchstart",this.onMouseDown,D?{passive:!1}:!1)},beforeUnmount:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)},methods:{delayHidden:function(){var e=this;clearTimeout(this.visibleTimeout),this.state.visible=!0,this.visibleTimeout=setTimeout(function(){e.state.visible=!1},2e3)},onScrollbarTouchStart:function(e){e.preventDefault()},onContainerMouseDown:function(e){e.stopPropagation(),e.preventDefault()},patchEvents:function(){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.thumbRef.current.addEventListener("touchmove",this.onMouseMove,D?{passive:!1}:!1),this.thumbRef.current.addEventListener("touchend",this.onMouseUp)},removeEvents:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.scrollbarRef.current.removeEventListener("touchstart",this.onScrollbarTouchStart,D?{passive:!1}:!1),this.thumbRef.current&&(this.thumbRef.current.removeEventListener("touchstart",this.onMouseDown,D?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchmove",this.onMouseMove,D?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchend",this.onMouseUp)),E.cancel(this.moveRaf)},onMouseDown:function(e){var t=this.$props.onStartMove;j(this.state,{dragging:!0,pageY:ce(e),startTop:this.getTop()}),t(),this.patchEvents(),e.stopPropagation(),e.preventDefault()},onMouseMove:function(e){var t=this.state,a=t.dragging,n=t.pageY,l=t.startTop,r=this.$props.onScroll;if(E.cancel(this.moveRaf),a){var v=ce(e)-n,s=l+v,h=this.getEnableScrollRange(),u=this.getEnableHeightRange(),d=u?s/u:0,c=Math.ceil(d*h);this.moveRaf=E(function(){r(c)})}},onMouseUp:function(){var e=this.$props.onStopMove;this.state.dragging=!1,e(),this.removeEvents()},getSpinHeight:function(){var e=this.$props,t=e.height,a=e.count,n=t/a*10;return n=Math.max(n,Ie),n=Math.min(n,t/2),Math.floor(n)},getEnableScrollRange:function(){var e=this.$props,t=e.scrollHeight,a=e.height;return t-a||0},getEnableHeightRange:function(){var e=this.$props.height,t=this.getSpinHeight();return e-t||0},getTop:function(){var e=this.$props.scrollTop,t=this.getEnableScrollRange(),a=this.getEnableHeightRange();if(e===0||t===0)return 0;var n=e/t;return n*a},showScroll:function(){var e=this.$props,t=e.height,a=e.scrollHeight;return a>t}},render:function(){var e=this.state,t=e.dragging,a=e.visible,n=this.$props.prefixCls,l=this.getSpinHeight()+"px",r=this.getTop()+"px",v=this.showScroll(),s=v&&a;return R("div",{ref:this.scrollbarRef,class:W("".concat(n,"-scrollbar"),q({},"".concat(n,"-scrollbar-show"),v)),style:{width:"8px",top:0,bottom:0,right:0,position:"absolute",display:s?void 0:"none"},onMousedown:this.onContainerMouseDown,onMousemove:this.delayHidden},[R("div",{ref:this.thumbRef,class:W("".concat(n,"-scrollbar-thumb"),q({},"".concat(n,"-scrollbar-thumb-moving"),t)),style:{width:"100%",height:l,top:r,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:"99px",cursor:"pointer",userSelect:"none"},onMousedown:this.onMouseDown},null)])}});function ke(i,e,t,a){var n=new Map,l=new Map,r=B(Symbol("update"));C(i,function(){r.value=Symbol("update")});var v=void 0;function s(){E.cancel(v)}function h(){s(),v=E(function(){n.forEach(function(d,c){if(d&&d.offsetParent){var g=d.offsetHeight;l.get(c)!==g&&(r.value=Symbol("update"),l.set(c,d.offsetHeight))}})})}function u(d,c){var g=e(d),b=n.get(g);c?(n.set(g,c.$el||c),h()):n.delete(g),!b!=!c&&(c?t==null||t(d):a==null||a(d))}return Ee(function(){s()}),[u,h,l,r]}function Pe(i,e,t,a,n,l,r,v){var s;return function(h){if(h==null){v();return}E.cancel(s);var u=e.value,d=a.itemHeight;if(typeof h=="number")r(h);else if(h&&ve(h)==="object"){var c,g=h.align;"index"in h?c=h.index:c=u.findIndex(function(M){return n(M)===h.key});var b=h.offset,p=b===void 0?0:b,P=function M(U,I){if(!(U<0||!i.value)){var $=i.value.clientHeight,Y=!1,S=I;if($){for(var H=I||g,w=0,x=0,T=0,N=Math.min(u.length,c),y=0;y<=N;y+=1){var K=n(u[y]);x=w;var z=t.get(K);T=x+(z===void 0?d:z),w=T,y===c&&z===void 0&&(Y=!0)}var O=i.value.scrollTop,_=null;switch(H){case"top":_=x-p;break;case"bottom":_=T-$+p;break;default:{var V=O+$;x<O?S="top":T>V&&(S="bottom")}}_!==null&&_!==O&&r(_)}s=E(function(){Y&&l(),M(U-1,S)},2)}};P(5)}}}var Ue=(typeof navigator>"u"?"undefined":ve(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Ye=Ue,pe=function(i,e){var t=!1,a=null;function n(){clearTimeout(a),t=!0,a=setTimeout(function(){t=!1},50)}return function(l){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=l<0&&i.value||l>0&&e.value;return r&&v?(clearTimeout(a),t=!1):(!v||t)&&n(),!t&&v}};function ze(i,e,t,a){var n=0,l=null,r=null,v=!1,s=pe(e,t);function h(d){if(!!i.value){E.cancel(l);var c=d.deltaY;n+=c,r=c,!s(c)&&(Ye||d.preventDefault(),l=E(function(){var g=v?10:1;a(n*g),n=0}))}}function u(d){!i.value||(v=d.detail===r)}return[h,u]}var Oe=14/15;function Ve(i,e,t){var a=!1,n=0,l=null,r=null,v=function(){l&&(l.removeEventListener("touchmove",s),l.removeEventListener("touchend",h))},s=function(g){if(a){var b=Math.ceil(g.touches[0].pageY),p=n-b;n=b,t(p)&&g.preventDefault(),clearInterval(r),r=setInterval(function(){p*=Oe,(!t(p,!0)||Math.abs(p)<=.1)&&clearInterval(r)},16)}},h=function(){a=!1,v()},u=function(g){v(),g.touches.length===1&&!a&&(a=!0,n=Math.ceil(g.touches[0].pageY),l=g.target,l.addEventListener("touchmove",s,{passive:!1}),l.addEventListener("touchend",h))},d=function(){};he(function(){document.addEventListener("touchmove",d,{passive:!1}),C(i,function(c){e.value.removeEventListener("touchstart",u),v(),clearInterval(r),c&&e.value.addEventListener("touchstart",u,{passive:!1})},{immediate:!0})}),de(function(){document.removeEventListener("touchmove",d)})}var Ae=["prefixCls","height","itemHeight","fullHeight","data","itemKey","virtual","component","onScroll","children","style","class"],Be=[],Ke={overflowY:"auto",overflowAnchor:"none"};function je(i,e,t,a,n,l){var r=l.getKey;return i.slice(e,t+1).map(function(v,s){var h=e+s,u=n(v,h,{}),d=r(v);return R(De,{key:d,setRef:function(g){return a(v,g)}},{default:function(){return[u]}})})}var We=fe({compatConfig:{MODE:3},name:"List",inheritAttrs:!1,props:{prefixCls:String,data:$e.array,height:Number,itemHeight:Number,fullHeight:{type:Boolean,default:void 0},itemKey:{type:[String,Number,Function],required:!0},component:{type:[String,Object]},virtual:{type:Boolean,default:void 0},children:Function,onScroll:Function,onMousedown:Function,onMouseenter:Function,onVisibleChange:Function},setup:function(e,t){var a=t.expose,n=k(function(){var o=e.height,f=e.itemHeight,m=e.virtual;return!!(m!==!1&&o&&f)}),l=k(function(){var o=e.height,f=e.itemHeight,m=e.data;return n.value&&m&&f*m.length>o}),r=ee({scrollTop:0,scrollMoving:!1}),v=k(function(){return e.data||Be}),s=le([]);C(v,function(){s.value=Le(v.value).slice()},{immediate:!0});var h=le(function(o){});C(function(){return e.itemKey},function(o){typeof o=="function"?h.value=o:h.value=function(f){return f==null?void 0:f[o]}},{immediate:!0});var u=B(),d=B(),c=B(),g=function(f){return h.value(f)},b={getKey:g};function p(o){var f;typeof o=="function"?f=o(r.scrollTop):f=o;var m=x(f);u.value&&(u.value.scrollTop=m),r.scrollTop=m}var P=ke(s,g,null,null),M=se(P,4),U=M[0],I=M[1],$=M[2],Y=M[3],S=ee({scrollHeight:void 0,start:0,end:0,offset:void 0}),H=B(0);he(function(){X(function(){var o;H.value=((o=d.value)===null||o===void 0?void 0:o.offsetHeight)||0})}),we(function(){X(function(){var o;H.value=((o=d.value)===null||o===void 0?void 0:o.offsetHeight)||0})}),C([n,s],function(){n.value||j(S,{scrollHeight:void 0,start:0,end:s.value.length-1,offset:void 0})},{immediate:!0}),C([n,s,H,l],function(){n.value&&!l.value&&j(S,{scrollHeight:H.value,start:0,end:s.value.length-1,offset:void 0}),u.value&&(r.scrollTop=u.value.scrollTop)},{immediate:!0}),C([l,n,function(){return r.scrollTop},s,Y,function(){return e.height},H],function(){if(!(!n.value||!l.value)){for(var o=0,f,m,L,J=s.value.length,be=s.value,re=r.scrollTop,ie=e.itemHeight,ae=e.height,Me=re+ae,A=0;A<J;A+=1){var Re=be[A],He=g(Re),Z=$.get(He);Z===void 0&&(Z=ie);var Q=o+Z;f===void 0&&Q>=re&&(f=A,m=o),L===void 0&&Q>Me&&(L=A),o=Q}f===void 0&&(f=0,m=0,L=Math.ceil(ae/ie)),L===void 0&&(L=J-1),L=Math.min(L+1,J),j(S,{scrollHeight:o,start:f,end:L,offset:m})}},{immediate:!0});var w=k(function(){return S.scrollHeight-e.height});function x(o){var f=o;return Number.isNaN(w.value)||(f=Math.min(f,w.value)),f=Math.max(f,0),f}var T=k(function(){return r.scrollTop<=0}),N=k(function(){return r.scrollTop>=w.value}),y=pe(T,N);function K(o){var f=o;p(f)}function z(o){var f,m=o.currentTarget.scrollTop;m!==r.scrollTop&&p(m),(f=e.onScroll)===null||f===void 0||f.call(e,o)}var O=ze(n,T,N,function(o){p(function(f){var m=f+o;return m})}),_=se(O,2),V=_[0],te=_[1];Ve(n,u,function(o,f){return y(o,f)?!1:(V({preventDefault:function(){},deltaY:o}),!0)});function ne(o){n.value&&o.preventDefault()}var oe=function(){u.value&&(u.value.removeEventListener("wheel",V,D?{passive:!1}:!1),u.value.removeEventListener("DOMMouseScroll",te),u.value.removeEventListener("MozMousePixelScroll",ne))};xe(function(){X(function(){u.value&&(oe(),u.value.addEventListener("wheel",V,D?{passive:!1}:!1),u.value.addEventListener("DOMMouseScroll",te),u.value.addEventListener("MozMousePixelScroll",ne))})}),de(function(){oe()});var me=Pe(u,s,$,e,g,I,p,function(){var o;(o=c.value)===null||o===void 0||o.delayHidden()});a({scrollTo:me});var Se=k(function(){var o=null;return e.height&&(o=F(q({},e.fullHeight?"height":"maxHeight",e.height+"px"),Ke),n.value&&(o.overflowY="hidden",r.scrollMoving&&(o.pointerEvents="none"))),o});return C([function(){return S.start},function(){return S.end},s],function(){if(e.onVisibleChange){var o=s.value.slice(S.start,S.end+1);e.onVisibleChange(o,s.value)}},{flush:"post"}),{state:r,mergedData:s,componentStyle:Se,onFallbackScroll:z,onScrollBar:K,componentRef:u,useVirtual:n,calRes:S,collectHeight:I,setInstance:U,sharedConfig:b,scrollBarRef:c,fillerInnerRef:d}},render:function(){var e=this,t=F(F({},this.$props),this.$attrs),a=t.prefixCls,n=a===void 0?"rc-virtual-list":a,l=t.height;t.itemHeight,t.fullHeight,t.data,t.itemKey,t.virtual;var r=t.component,v=r===void 0?"div":r;t.onScroll;var s=t.children,h=s===void 0?this.$slots.default:s,u=t.style,d=t.class,c=_e(t,Ae),g=W(n,d),b=this.state.scrollTop,p=this.calRes,P=p.scrollHeight,M=p.offset,U=p.start,I=p.end,$=this.componentStyle,Y=this.onFallbackScroll,S=this.onScrollBar,H=this.useVirtual,w=this.collectHeight,x=this.sharedConfig,T=this.setInstance,N=this.mergedData;return R("div",F({style:F(F({},u),{},{position:"relative"}),class:g},c),[R(v,{class:"".concat(n,"-holder"),style:$,ref:"componentRef",onScroll:Y},{default:function(){return[R(Ce,{prefixCls:n,height:P,offset:M,onInnerResize:w,ref:"fillerInnerRef"},{default:function(){return je(N,U,I,T,h,x)}})]}}),H&&R(Ne,{ref:"scrollBarRef",prefixCls:n,scrollTop:b,height:l,scrollHeight:P,count:N.length,onScroll:S,onStartMove:function(){e.state.scrollMoving=!0},onStopMove:function(){e.state.scrollMoving=!1}},null)])}});const Qe=We;export{Qe as L,ue as c};
